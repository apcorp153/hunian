<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Properti - Hunian153</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --bg-light: #f8fafc;
        }
        body { background-color: var(--bg-light); font-family: 'Segoe UI', sans-serif; }
        
        .main-img { 
            width: 100%; 
            height: 450px; 
            object-fit: cover; 
            border-radius: 24px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .spec-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            border: 1px solid #e2e8f0;
            height: 100%;
        }

        .spec-card i { color: var(--primary-blue); margin-bottom: 8px; }
        .spec-label { display: block; font-size: 12px; color: #64748b; font-weight: 600; }
        .spec-value { display: block; font-size: 16px; font-weight: 700; color: #1e293b; }

        .price-tag {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-blue);
        }

        .back-btn {
            background: white;
            color: #1e293b;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .back-btn:hover { background: #f1f5f9; transform: translateX(-5px); }

        .btn-wa-large {
            background-color: #25d366;
            color: white;
            border: none;
            padding: 18px;
            border-radius: 18px;
            font-weight: 700;
            font-size: 1.1rem;
            transition: 0.3s;
        }
        .btn-wa-large:hover { background-color: #128c7e; color: white; transform: translateY(-3px); }

        @media (max-width: 768px) {
            .main-img { height: 300px; }
        }
    </style>
</head>
<body>

<div class="container py-4">
    <a href="index.html" class="back-btn mb-4">
        <i data-lucide="arrow-left" size="18"></i> Kembali ke Katalog
    </a>
    
    <div id="detail-content" class="row g-4">
        <div class="col-12 text-center py-5">
            <div class="spinner-border text-primary" role="status"></div>
            <p class="mt-3 text-muted">Mengambil detail hunian...</p>
        </div>
    </div>
</div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbzCrNX6mtDRz_IBqCXhwWx_YKZTrYgIILx_mGyWEKFZckzTls58MRgjh2yE42m3ZDdg/exec";
    const urlParams = new URLSearchParams(window.location.search);
    const namaProperti = urlParams.get('nama');

    async function fetchDetail() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();
            const item = data.find(p => p.Nama_Properti === namaProperti);
            
            if (item) {
                renderDetail(item);
            } else {
                document.getElementById('detail-content').innerHTML = `
                    <div class="col-12 text-center py-5">
                        <i data-lucide="search-x" size="64" class="text-muted mb-3"></i>
                        <h2>Waduh, Properti Tidak Ditemukan!</h2>
                        <p>Mungkin link sudah kedaluwarsa atau nama properti berubah.</p>
                        <a href="index.html" class="btn btn-primary mt-3">Cek Katalog Lainnya</a>
                    </div>
                `;
                lucide.createIcons();
            }
        } catch (error) {
            console.error(error);
            document.getElementById('detail-content').innerHTML = "<p class="text-center">Gagal memuat data. Periksa koneksi internet.</p>";
        }
    }

    function renderDetail(item) {
        document.title = `${item.Nama_Properti} - Hunian153`;
        
        // Logika Harga
        const hargaJual = item.Harga_Jual ? "Rp " + parseInt(item.Harga_Jual).toLocaleString('id-ID') : "";
        const hargaSewa = item.Harga_Sewa ? "Rp " + parseInt(item.Harga_Sewa).toLocaleString('id-ID') : "";
        const displayHarga = hargaJual || hargaSewa || item.Harga || "Hubungi Kami";

        const container = document.getElementById('detail-content');
        container.innerHTML = `
            <div class="col-lg-7">
                <img src="${item.Link_Foto}" class="main-img shadow" alt="${item.Nama_Properti}" onerror="this.src='https://images.unsplash.com/photo-1564013799919-ab600027ffc6?q=80&w=1000&auto=format&fit=crop'">
                
                <div class="row g-3 mt-3">
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="maximize"></i>
                            <span class="spec-label">Tanah</span>
                            <span class="spec-value">${item.Luas_Tanah || '-'}m²</span>
                        </div>
                    </div>
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="home"></i>
                            <span class="spec-label">Bangun</span>
                            <span class="spec-value">${item.Luas_Bangunan || '-'}m²</span>
                        </div>
                    </div>
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="bed-double"></i>
                            <span class="spec-label">Tidur</span>
                            <span class="spec-value">${item.Kamar_Tidur || '0'}</span>
                        </div>
                    </div>
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="bath"></i>
                            <span class="spec-label">Mandi</span>
                            <span class="spec-value">${item.Kamar_Mandi || '0'}</span>
                        </div>
                    </div>
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="compass"></i>
                            <span class="spec-label">Hadap</span>
                            <span class="spec-value">${item.Arah_Hadap || '-'}</span>
                        </div>
                    </div>
                    <div class="col-4 col-md-2">
                        <div class="spec-card">
                            <i data-lucide="Zap"></i>
                            <span class="spec-label">Listrik</span>
                            <span class="spec-value">${item.Listrik || '-'}W</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-5">
                <div class="ps-lg-4">
                    <span class="badge bg-success px-3 py-2 rounded-pill mb-3">${item.Status || 'DIJUAL'}</span>
                    <h1 class="fw-bold display-6 mb-2">${item.Nama_Properti}</h1>
                    <p class="text-muted mb-4"><i data-lucide="map-pin" size="18"></i> ${item.Kecamatan || 'Semarang'}</p>
                    
                    <div class="mb-4">
                        <span class="text-muted d-block small fw-bold uppercase">HARGA PENAWARAN</span>
                        <div class="price-tag">${displayHarga}</div>
                    </div>

                    <hr>

                    <h5 class="fw-bold mb-3">Deskripsi</h5>
                    <p class="text-secondary" style="white-space: pre-line; line-height: 1.8;">
                        ${item.Deskripsi || 'Hubungi agen untuk informasi deskripsi lebih lengkap mengenai properti ini.'}
                    </p>

                    <div class="d-grid gap-2 mt-5">
                        <a href="https://wa.me/628123456789?text=Halo Hunian153, saya tertarik dengan ${item.Nama_Properti}. Apakah bisa dijadwalkan survei?" 
                           target="_blank" 
                           class="btn btn-wa-large d-flex align-items-center justify-content-center gap-2">
                            <i data-lucide="message-circle"></i> Chat WhatsApp & Survei
                        </a>
                    </div>
                </div>
            </div>
        `;
        lucide.createIcons();
    }

    if (namaProperti) {
        fetchDetail();
    } else {
        window.location.href = 'index.html';
    }
</script>
</body>
</html>
